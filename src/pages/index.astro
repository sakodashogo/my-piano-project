---
import Layout from "../layouts/Layout.astro";
import { client } from "../lib/microcms";
import { Image } from "astro:assets";
import { areas } from "../data/areas";

// SEO用の設定
const pageTitle =
  "江東区・清澄白河のピアノ教室｜出張レッスン専門・髙橋遊月ピアノ教室";
const pageDescription =
  "江東区・清澄白河でピアノ教室をお探しの方へ。当教室は講師がご自宅へ伺う「出張型」のピアノ教室です。お子様の送り迎えの負担もゼロに。仕事帰りにいつもの環境でリラックスしてレッスンを受けられます。東京音大卒の女性講師によるマンツーマン指導。";
import heroPiano from "../assets/images/hero-piano.webp";
const heroImage = heroPiano.src;

// YouTube動画のデータ構成
import thumb1 from "../assets/images/thumbnails/xh65ftmaIgc.jpg";
import thumb2 from "../assets/images/thumbnails/OIRmBSviWrw.jpg";
import thumb3 from "../assets/images/thumbnails/31muaoyHDuo.jpg";
import senzaiWebp from "../assets/images/senzai.webp";

const videos = [
  { id: "xh65ftmaIgc", thumbnail: thumb1 },
  { id: "OIRmBSviWrw", thumbnail: thumb2 },
  { id: "31muaoyHDuo", thumbnail: thumb3 },
];

// microCMSからお知らせを取得
const response = await client.get({
  endpoint: "news",
  queries: { limit: 3, fields: ["id", "title", "publishedAt"] },
});
const newsContents = response.contents;

// 構造化データ
const schema = JSON.stringify({
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "MusicSchool",
      "@id": "https://playon-music.jp/#business",
      name: "髙橋遊月ピアノ教室",
      description: pageDescription,
      image: heroImage,
      url: "https://playon-music.jp",
      address: {
        "@type": "PostalAddress",
        addressRegion: "東京都",
        addressLocality: "江東区",
      },
      areaServed: [
        "江東区",
        "清澄白河",
        "門前仲町",
        "木場",
        "深川",
        "森下",
        "白河",
        "三好",
        "平野",
        "住吉",
        "豊洲",
        "佐賀",
        "永代",
        "福住",
        "冬木",
        "牡丹",
        "古石場",
        "越中島",
        "菊川",
        "千歳",
        "中央区",
        "月島",
        "晴海",
        "勝どき",
        "水天宮前",
        "茅場町",
        "人形町",
        "日本橋浜町",
        "日本橋中洲",
        "日本橋蛎殻町",
        "日本橋箱崎町",
        "墨田区",
        "立川",
        "緑",
        "台東区",
        "蔵前",
        "清澄白河駅",
        "門前仲町駅",
        "木場駅",
        "水天宮前駅",
        "茅場町駅",
        "人形町駅",
        "大江戸線沿線",
        "半蔵門線沿線",
        "東西線沿線",
      ],
      serviceType: [
        "ピアノ家庭教師",
        "ピアノ訪問レッスン",
        "ピアノ出張レッスン",
        "マンツーマンレッスン",
        "個人指導",
      ],
      priceRange: "5,000円〜",
      instructor: {
        "@type": "Person",
        name: "髙橋 遊月",
        alumniOf: "東京音楽大学",
      },
    },
    {
      "@type": "BreadcrumbList",
      itemListElement: [
        {
          "@type": "ListItem",
          position: 1,
          name: "Home",
          item: "https://playon-music.jp",
        },
      ],
    },
  ],
});
---

<Layout title={pageTitle} description={pageDescription} image={heroImage}>
  <script type="application/ld+json" set:html={schema} slot="head" />

  <link
    rel="preload"
    as="image"
    href={heroImage}
    fetchpriority="high"
    slot="preload"
  />

  <main class="bg-[#FCFAF7] text-[#544A40] font-sans relative">
    <section
      class="relative h-[85vh] flex items-center justify-center overflow-hidden"
    >
      <div class="absolute inset-0 z-0">
        <Image
          src={heroPiano}
          alt="落ち着いた空間でのピアノレッスン"
          width={1200}
          height={800}
          class="w-full h-full object-cover opacity-50"
          loading="eager"
          fetchpriority="high"
        />
        <div
          class="absolute inset-0 bg-gradient-to-b from-[#FCFAF7]/20 to-[#FCFAF7]"
        >
        </div>
      </div>

      <div class="relative z-10 text-center px-4 max-w-5xl">
        <h1 class="font-serif text-[#544A40] flex flex-col items-center">
          <span
            class="block text-lg md:text-2xl tracking-[0.1em] mb-6 text-[#433D3C] font-bold"
          >
            江東区・清澄白河のピアノ教室
          </span>

          <span class="flex items-center gap-4 mb-8">
            <span class="h-[1px] w-8 bg-[#8B7355]"></span>
            <span
              class="text-lg md:text-xl tracking-[0.1em] text-[#433D3C] font-bold"
              >出張レッスン専門</span
            >
            <span class="h-[1px] w-8 bg-[#8B7355]"></span>
          </span>

          <span
            class="block text-3xl md:text-4xl lg:text-5xl font-medium tracking-tighter mb-10 leading-tight text-[#333333]"
          >
            髙橋遊月ピアノ教室
          </span>
        </h1>
        <p
          class="font-serif text-base md:text-lg leading-[2.5] tracking-widest text-[#333333] font-medium"
        >
          講師がご自宅へ伺い、<br
            class="md:hidden"
          />あなたの大切なピアノで、<br />
          あなただけの音色を<br class="md:hidden" />一緒に奏でます。
        </p>
      </div>
    </section>

    <section class="py-12 px-6 max-w-4xl mx-auto">
      <h2 class="text-2xl md:text-3xl font-serif mb-4 text-center">お知らせ</h2>
      <div
        class="flex items-center justify-center gap-4 text-[#A88B58] text-xs tracking-[0.2em] font-serif mb-12"
      >
        <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
        News
        <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
      </div>
      <div class="space-y-3">
        {
          newsContents.length > 0 ? (
            newsContents.map((item: any) => (
              <a href={`/news/${item.id}`} class="block group">
                <div class="bg-white/60 backdrop-blur-sm p-4 rounded-lg border border-[#E8E2D9] flex flex-col md:flex-row md:items-center gap-4 transition-all group-hover:bg-white group-hover:shadow-md">
                  <span class="text-xs opacity-50 font-mono italic">
                    {new Date(item.publishedAt).toLocaleDateString("ja-JP")}
                  </span>
                  <span class="text-sm tracking-wide group-hover:text-[#A88B58] transition-colors">
                    {item.title}
                  </span>
                  <span class="hidden md:block ml-auto text-xs text-[#A88B58] opacity-0 group-hover:opacity-100 transition-opacity">
                    Read more →
                  </span>
                </div>
              </a>
            ))
          ) : (
            <p class="text-sm opacity-60 text-center">
              現在お知らせはありません。
            </p>
          )
        }
      </div>
      <div class="mt-8 text-right">
        <a
          href="/news"
          class="text-xs font-bold tracking-widest text-[#A88B58] hover:text-[#8B7347] border-b border-[#A88B58] pb-1 transition-colors"
        >
          お知らせ一覧を見る →
        </a>
      </div>
    </section>

    <section id="profile" class="py-24 bg-white">
      <div class="max-w-5xl mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="text-2xl md:text-3xl font-serif mb-4">講師紹介</h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Profile
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
        </div>
        <div class="grid md:grid-cols-2 gap-16 items-center">
          <div class="relative">
            <div
              class="aspect-[4/5] overflow-hidden rounded-t-[100px] rounded-b-lg shadow-2xl"
            >
              <Image
                src={senzaiWebp}
                alt="髙橋遊月"
                width={600}
                height={750}
                class="w-full h-full object-cover"
                loading="lazy"
              />
            </div>
            <div
              class="absolute -bottom-6 -right-6 w-48 h-48 bg-[#A88B58]/10 rounded-full -z-10 blur-2xl"
            >
            </div>
          </div>
          <div>
            <h3 class="text-3xl font-serif mb-6 leading-snug">
              髙橋 遊月 <span
                class="text-lg opacity-60 ml-2 font-light italic text-[#8B7355]"
                >Takahashi Yuzuki</span
              >
            </h3>
            <div class="space-y-6 text-[#544A40] leading-relaxed">
              <p class="font-bold border-b border-[#E8E2D9] pb-2 inline-block">
                東京音楽大学 卒業
              </p>
              <p>
                江東区・清澄白河を中心に、ご自宅へのピアノ家庭教師（出張レッスン）を行っております。
                これまで多くの門下生を指導し、音楽を通じた心の交流を大切にしてきました。
              </p>
              <p>
                「出張レッスン」だからこそ、移動の負担なく、いつもの慣れ親しんだピアノでリラックスして学んでいただけます。
                きめ細やかな指導で、技術だけでなく、音楽を一生のパートナーにするお手伝いをいたします。
              </p>
            </div>
            <div
              class="mt-10 p-8 bg-[#FCFAF7] rounded-2xl shadow-sm border border-[#F1EBE4] relative"
            >
              <span
                class="absolute top-4 left-4 text-4xl text-[#A88B58]/20 font-serif italic"
                >"</span
              >
              <p class="italic text-sm leading-loose">
                音楽は、言葉にできない感情を表現してくれる大切な友。技術の習得はもちろん、お一人おひとりの生活に寄り添う、穏やかで上質な時間を提供いたします。
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    {/* --- 動画セクション（Pass-through版） --- */}
    <section class="py-24 bg-[#FCFAF7] overflow-hidden">
      <div class="w-full max-w-[1400px] mx-auto">
        <div class="text-center mb-12 px-6">
          <h2 class="text-2xl md:text-3xl font-serif mb-4">紹介動画</h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Movie
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
        </div>
        <div class="relative py-4">
          <div
            id="video-slider"
            class="flex overflow-x-auto gap-6 px-[7.5%] md:px-[15%] pb-8 items-center transition-opacity duration-500"
            style="scrollbar-width: none; -ms-overflow-style: none; visibility: hidden; opacity: 0;"
          >
            {
              videos.map((video, index) => (
                <div
                  class="video-slide min-w-[85%] md:min-w-[70%] lg:min-w-[55%] snap-center transition-all duration-500 ease-out opacity-40 scale-95 lg:scale-[0.93] origin-center relative"
                  data-index={index}
                >
                  <div class="video-wrapper group aspect-video w-full rounded-2xl overflow-hidden shadow-xl border border-[#E8E2D9] bg-black relative">
                    {/* ▼ iframeを最初から表示（ユーザーが直接タップできるようにする）。
                    idを付与してJSから制御できるようにする。
                  */}
                    <iframe
                      id={`player-${index}`}
                      data-src={`https://www.youtube.com/embed/${video.id}?enablejsapi=1&rel=0&modestbranding=1&controls=1`}
                      title="YouTube video player"
                      class="w-full h-full absolute top-0 left-0 z-10 scale-[1.02]"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                      loading="lazy"
                    />

                    {/* ▼ 独自のサムネイル画像（ローカル資産を使用） */}
                    <Image
                      src={video.thumbnail}
                      alt="Video thumbnail"
                      width={520}
                      height={293}
                      class="video-thumbnail video-poster absolute inset-0 z-20 w-full h-full object-cover transition-opacity duration-300 pointer-events-none"
                    />

                    {/* ▼ 独自の再生ボタン（オーバーレイ）
                     pointer-events-none でクリックを貫通させる。
                     これでユーザーのタップは直接iframeに届く。
                  */}
                    <div
                      class="hidden md:block absolute inset-0 z-40 bg-transparent cursor-pointer slide-click-area"
                      data-index={index}
                    />
                    <div
                      class="video-overlay absolute inset-0 z-30 flex items-center justify-center bg-black/10 cursor-pointer pointer-events-auto md:pointer-events-none video-trigger-area"
                      data-index={index}
                    >
                      <button
                        class="bg-white/90 text-[#A88B58] rounded-full p-4 md:p-5 shadow-2xl backdrop-blur-sm transform transition-transform duration-300 group-hover:scale-110"
                        aria-label="再生する"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 0 24 24"
                          fill="currentColor"
                          class="w-8 h-8 md:w-10 md:h-10 pl-1"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z"
                            clip-rule="evenodd"
                          />
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
              ))
            }
          </div>

          <div class="flex justify-center gap-3 mt-2">
            {
              videos.map((_, index) => (
                <button
                  class="slider-dot w-2 h-2 rounded-full bg-[#E8E2D9] transition-all duration-300 hover:bg-[#A88B58]/50"
                  data-index={index}
                  aria-label={`${index + 1}番目の動画へ`}
                />
              ))
            }
          </div>
        </div>

        <p
          class="mt-8 text-center text-[#6B5F54] text-sm leading-loose font-serif px-6"
        >
          レッスンの雰囲気や演奏の様子を<br
            class="md:hidden"
          />動画でご覧いただけます。<br />
          <span class="text-xs opacity-70 md:hidden"
            >※左右にスワイプして他の動画をご覧になれます。</span
          >
          <span class="text-xs opacity-70 hidden md:inline"
            >※左右の動画をクリックして他の動画をご覧になれます。</span
          >
        </p>
      </div>
    </section>

    <section class="py-24 bg-white">
      <div class="max-w-5xl mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="text-2xl md:text-3xl font-serif mb-4 whitespace-nowrap">
            あなたに合わせたレッスンを
          </h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Personalized Lesson
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
        </div>
        <div class="grid md:grid-cols-3 gap-10">
          <div class="flex flex-col items-center text-center">
            <div
              class="w-16 h-16 bg-[#F7F3EE] rounded-full flex items-center justify-center mb-6 text-[#A88B58]"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-8 h-8"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
            </div>
            <h3 class="text-lg font-bold text-[#544A40] mb-4 font-serif">
              初心者の方も安心
            </h3>
            <p class="text-sm leading-loose text-[#6B5F54]">
              楽譜が読めなくても大丈夫です。<br />
              <span class="inline-block">基礎から丁寧に、</span><span
                class="inline-block">あなたのペースに合わせて</span
              ><span class="inline-block">サポートいたします。</span>
            </p>
          </div>
          <div class="flex flex-col items-center text-center">
            <div
              class="w-16 h-16 bg-[#F7F3EE] rounded-full flex items-center justify-center mb-6 text-[#A88B58]"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-8 h-8"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
                ></path>
              </svg>
            </div>
            <h3 class="text-lg font-bold text-[#544A40] mb-4 font-serif">
              年齢不問
            </h3>
            <p class="text-sm leading-loose text-[#6B5F54]">
              0歳のお子様からシニアの方まで。<br />
              <span class="inline-block"
                >「弾きたい」と思ったその時が、始めどきです。</span
              ><span class="inline-block">年齢制限はありません。</span>
            </p>
          </div>
          <div class="flex flex-col items-center text-center">
            <div
              class="w-16 h-16 bg-[#F7F3EE] rounded-full flex items-center justify-center mb-6 text-[#A88B58]"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-8 h-8"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"
                ></path>
              </svg>
            </div>
            <h3 class="text-lg font-bold text-[#544A40] mb-4 font-serif">
              それぞれの目的で
            </h3>
            <p class="text-sm leading-loose text-[#6B5F54]">
              趣味として楽しみたい、あの曲を弾けるようになりたい、本格的に学びたい。ご希望に寄り添います。
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="py-24 bg-[#F7F3EE]">
      <div class="max-w-5xl mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="text-2xl md:text-3xl font-serif mb-4">レッスンスタイル</h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Lesson Style
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
        </div>
        <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
          <div
            class="bg-white p-8 rounded-xl border border-[#E8E2D9] flex flex-col items-start h-full shadow-sm"
          >
            <h3
              class="text-lg md:text-xl font-bold font-serif mb-4 text-[#544A40]"
            >
              ご自宅への訪問レッスン
            </h3>
            <p class="text-sm md:text-base leading-loose text-[#6B5F54] flex-1">
              講師がご自宅へ出張し、いつものピアノでマンツーマンの個人指導を行います。<span
                class="font-bold text-[#A88B58]">送迎不要</span
              >で保護者の方の負担も軽減。仕事帰りの時間帯も対応可能です。
            </p>
            <div class="mt-4 flex flex-wrap gap-2">
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >送迎不要</span
              >
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >マンツーマン</span
              >
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >仕事帰りOK</span
              >
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >体験レッスンあり</span
              >
            </div>
          </div>
          <div
            class="bg-white p-8 rounded-xl border border-[#E8E2D9] flex flex-col items-start h-full shadow-sm"
          >
            <h3
              class="text-lg md:text-xl font-bold font-serif mb-4 text-[#544A40]"
            >
              スタジオレッスン
            </h3>
            <p class="text-sm md:text-base leading-loose text-[#6B5F54] flex-1">
              ご自宅にピアノがない場合や、グランドピアノで練習したい場合は、近隣のレンタルスタジオ等でのレッスンも可能です。<br
              />
              <span class="text-xs text-[#A88B58] mt-3 block"
                >※練習室レンタルの場合、別途会場費がかかります。</span
              >
            </p>
            <div class="mt-4 flex flex-wrap gap-2">
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >マンツーマン</span
              >
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >仕事帰りOK</span
              >
              <span
                class="text-xs bg-[#A88B58]/10 text-[#A88B58] px-3 py-1 rounded-full font-medium"
                >体験レッスンあり</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="py-24 bg-[#FCFAF7]">
      <div class="max-w-5xl mx-auto px-6 text-center mb-12">
        <h2 class="text-2xl md:text-3xl font-serif mb-4">
          レッスン料金・システム
        </h2>
        <div
          class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
        >
          <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          Fees & System
          <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
        </div>
      </div>
      <div
        class="bg-white p-5 md:p-10 rounded-2xl shadow-sm border border-[#E8E2D9] text-center w-[90%] md:w-auto max-w-md md:max-w-2xl mx-auto"
      >
        <div class="mb-10 font-serif text-[#544A40]">
          <p class="mb-8 text-lg tracking-widest text-[#544A40]">
            - 1レッスンあたりの料金 -
          </p>
          <div
            class="flex flex-row justify-center items-center gap-2 md:gap-10"
          >
            <div
              class="flex flex-col items-center min-w-[70px] md:min-w-[90px]"
            >
              <span
                class="text-sm md:text-lg text-[#A88B58] mb-1 md:mb-2 font-medium"
                >30分</span
              >
              <div class="flex items-baseline justify-center">
                <span
                  class="text-xl md:text-3xl font-medium font-serif text-[#544A40]"
                  >5,000</span
                >
                <span class="text-xs md:text-sm text-[#544A40] ml-0.5 font-bold"
                  >円</span
                >
              </div>
            </div>
            <div
              class="flex flex-col items-center border-l border-[#E8E2D9] pl-2 md:pl-10 min-w-[70px] md:min-w-[90px]"
            >
              <span
                class="text-sm md:text-lg text-[#A88B58] mb-1 md:mb-2 font-medium"
                >45分</span
              >
              <div class="flex items-baseline justify-center">
                <span
                  class="text-xl md:text-3xl font-medium font-serif text-[#544A40]"
                  >7,500</span
                >
                <span class="text-xs md:text-sm text-[#544A40] ml-0.5 font-bold"
                  >円</span
                >
              </div>
            </div>
            <div
              class="flex flex-col items-center border-l border-[#E8E2D9] pl-2 md:pl-10 min-w-[70px] md:min-w-[90px]"
            >
              <span
                class="text-sm md:text-lg text-[#A88B58] mb-1 md:mb-2 font-medium"
                >60分</span
              >
              <div class="flex items-baseline justify-center">
                <span
                  class="text-xl md:text-3xl font-medium font-serif text-[#544A40]"
                  >10,000</span
                >
                <span class="text-xs md:text-sm text-[#544A40] ml-0.5 font-bold"
                  >円</span
                >
              </div>
            </div>
          </div>
        </div>
        <p
          class="text-sm leading-loose tracking-wide mb-10 text-[#6B5F54] text-left md:text-center"
        >
          ご希望に合わせて、30分・45分・60分のコースをご用意しております。<br />
          月1回〜4回まで、ライフスタイルに合わせて受講頻度をお選びいただけます。
        </p>
        <a
          href="/lesson"
          class="inline-block border border-[#A88B58] text-[#A88B58] px-10 py-4 rounded-full hover:bg-[#A88B58] hover:text-white transition-all text-sm tracking-widest font-medium"
        >
          詳しい料金プランを見る →
        </a>
      </div>
    </section>

    <section class="py-24 px-6 bg-white border-t border-[#F1EBE4]">
      <div class="max-w-5xl mx-auto text-center">
        <div class="mb-16">
          <h2 class="text-2xl md:text-3xl font-serif mb-4">出張対応エリア</h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Service Area
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
        </div>
        <p
          class="text-base leading-loose mb-10 text-[#6B5F54] max-w-2xl mx-auto"
        >
          江東区の<span class="font-bold text-[#A88B58]"
            >清澄白河駅・門前仲町駅</span
          >周辺を中心に、<br class="hidden md:inline" />
          公共交通機関で伺える範囲で活動しています。
        </p>
        <div class="grid md:grid-cols-2 gap-8 items-stretch text-left mb-12">
          <div
            class="hidden md:block w-full rounded-2xl overflow-hidden shadow-sm border border-[#E8E2D9]"
          >
            <iframe
              src="https://maps.google.com/maps?q=%E6%B8%85%E6%BE%84%E7%99%BD%E6%B2%B3%E9%A7%85&t=m&z=15&output=embed&iwloc=near"
              width="100%"
              height="100%"
              style="border:0;"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              title="清澄白河駅周辺地図"
            >
            </iframe>
          </div>
          <div>
            <p class="text-xs text-[#A88B58] font-bold mb-2 tracking-wide">
              江東区
            </p>
            <div class="flex flex-wrap gap-2 mb-4">
              {
                [
                  "清澄白河",
                  "門前仲町",
                  "木場",
                  "深川",
                  "森下",
                  "白河",
                  "三好",
                  "平野",
                  "住吉",
                  "豊洲",
                  "佐賀",
                  "永代",
                  "福住",
                  "冬木",
                  "牡丹",
                  "古石場",
                  "越中島",
                  "菊川",
                  "千歳",
                ].map((areaName) => {
                  // エリア名から該当するslugを探すヘルパーロジック
                  const foundArea = areas.find(
                    (a) =>
                      a.subAreas.includes(areaName) ||
                      a.name.includes(areaName),
                  );
                  const slug = foundArea ? foundArea.slug : null;

                  return slug ? (
                    <a
                      href={`/area/${slug}`}
                      class="inline-block px-3 py-1.5 bg-white text-[#544A40] text-xs rounded-full border border-[#E8E2D9] hover:border-[#A88B58] hover:text-[#A88B58] hover:bg-[#A88B58]/10 transition-colors duration-300"
                    >
                      {areaName}
                    </a>
                  ) : (
                    <span class="inline-block px-3 py-1.5 bg-white text-[#544A40] text-xs rounded-full border border-[#E8E2D9] cursor-default">
                      {areaName}
                    </span>
                  );
                })
              }
            </div>
            <p class="text-xs text-[#A88B58] font-bold mb-2 tracking-wide">
              中央区・墨田区・台東区（近郊）
            </p>
            <div class="flex flex-wrap gap-2 mb-4">
              {
                [
                  "月島",
                  "晴海",
                  "勝どき",
                  "水天宮前",
                  "茅場町",
                  "人形町",
                  "日本橋浜町",
                  "日本橋中洲",
                  "日本橋蛎殻町",
                  "日本橋箱崎町",
                  "立川",
                  "緑",
                  "蔵前（台東区）",
                ].map((areaName) => {
                  // エリア名から該当するslugを探すヘルパーロジック (簡易的な正規化を含む)
                  // "日本橋" や "（台東区）" を削除してデータと照合する
                  const searchName = areaName
                    .replace("（台東区）", "")
                    .replace("日本橋", "");
                  const foundArea = areas.find(
                    (a) =>
                      a.subAreas.includes(searchName) ||
                      a.name.includes(searchName),
                  );
                  const slug = foundArea ? foundArea.slug : null;

                  return slug ? (
                    <a
                      href={`/area/${slug}`}
                      class="inline-block px-3 py-1.5 bg-white text-[#544A40] text-xs rounded-full border border-[#E8E2D9] hover:border-[#A88B58] hover:text-[#A88B58] hover:bg-[#A88B58]/10 transition-colors duration-300"
                    >
                      {areaName}
                    </a>
                  ) : (
                    <span class="inline-block px-3 py-1.5 bg-white text-[#544A40] text-xs rounded-full border border-[#E8E2D9] cursor-default">
                      {areaName}
                    </span>
                  );
                })
              }
            </div>
            <p class="text-xs text-[#A88B58] font-bold mb-4 tracking-wide">
              アクセス路線
            </p>
            <div class="flex flex-wrap gap-2 mb-8">
              {
                [
                  "都営大江戸線",
                  "東京メトロ半蔵門線",
                  "東京メトロ東西線",
                  "都営新宿線",
                ].map((line) => (
                  <span class="inline-block px-3 py-1.5 bg-white text-[#544A40] text-xs rounded-full border border-[#E8E2D9] cursor-default">
                    {line}
                  </span>
                ))
              }
            </div>
            <div class="bg-[#F7F3EE] p-6 rounded-xl border border-[#E8E2D9]">
              <p
                class="text-base font-bold text-[#544A40] mb-2 font-serif border-l-2 border-[#A88B58] pl-3"
              >
                その他の地域について
              </p>
              <p class="text-sm leading-loose text-[#6B5F54]">
                上記以外の地域（中央区や墨田区、台東区の一部など）でも、近隣であれば対応可能な場合がございます。<br
                />
                「自宅まで来てもらえるかな？」と迷われた際は、まずはお気軽に<a
                  href="/contact"
                  class="underline hover:text-[#A88B58] transition-colors"
                  >お問い合わせフォーム</a
                >からご相談ください。
              </p>
            </div>
          </div>
        </div>

        <div class="mt-12 text-center">
          <a
            href="/area"
            class="inline-block border border-[#A88B58] text-[#A88B58] px-10 py-3 rounded-full hover:bg-[#A88B58] hover:text-white transition-all text-sm tracking-widest font-medium"
          >
            出張対応エリアページを見る →
          </a>
        </div>
      </div>
    </section>

    <section id="contact" class="py-24 bg-[#EAE3DA]">
      <div class="max-w-2xl mx-auto px-6">
        <div
          class="bg-white p-6 md:p-12 rounded-[2rem] shadow-2xl border border-[#DCD3C7] text-center"
        >
          <h2 class="text-2xl md:text-3xl font-serif mb-2">お問い合わせ</h2>
          <div
            class="flex items-center justify-center gap-4 text-[#A88B58] text-[10px] md:text-xs tracking-[0.2em] font-serif uppercase mb-8"
          >
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
            Contact
            <div class="h-[1px] w-8 bg-[#A88B58]/30"></div>
          </div>
          <p class="mb-10 text-sm leading-loose tracking-widest">
            体験レッスンのお申し込みや、<br />
            レッスンに関するご質問など、<br />
            お気軽にお問い合わせください。
          </p>
          <a
            href="/contact"
            class="inline-block bg-[#544A40] text-white px-8 md:px-12 py-5 rounded-full font-bold hover:bg-[#3D352E] transition-all shadow-lg tracking-[0.2em] text-sm transform hover:-translate-y-1 whitespace-nowrap"
          >
            お問い合わせフォームへ
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  #video-slider::-webkit-scrollbar {
    display: none;
  }

  .video-slide {
    will-change: transform, opacity;
  }

  /* pointer-events-noneユーティリティが効かない場合のための念の為のCSS */
  .video-slide .video-overlay,
  .video-slide .video-poster {
    pointer-events: none;
  }

  /* iframeはクリック可能 */
  .video-slide iframe {
    pointer-events: auto;
  }

  .video-slide.is-playing .video-overlay,
  .video-slide.is-playing .video-poster {
    opacity: 0;
    /* 再生中は完全に非表示にする */
    visibility: hidden;
    transition:
      opacity 0.5s ease,
      visibility 0.5s;
  }

  .video-slide.active {
    opacity: 1;
    transform: scale(1);
    z-index: 10;
  }

  /* PCのみ: アクティブなスライドではスライド全体のクリック判定を消して、再生ボタン付きのオーバーレイを優先する */
  .video-slide.active .slide-click-area {
    display: none;
  }

  /* PCのみ: 非再生時はオーバーレイをクリック可能にする */
  .video-slide:not(.is-playing) .video-overlay {
    pointer-events: auto;
  }

  /* モバイル動画UX改善 */
  @media (max-width: 767px) {
    /* 再生前はiframeへのタッチを無効化（スワイプ優先） */
    .video-slide:not(.is-playing) iframe {
      pointer-events: none;
    }

    /* 再生中はiframeのコントロールを有効に */
    .video-slide.is-playing iframe {
      pointer-events: auto;
    }

    /* 再生前のオーバーレイはタップ可能 */
    .video-slide:not(.is-playing) .video-overlay {
      pointer-events: auto;
    }
  }
</style>

<script>
  // グローバル宣言（TypeScriptエラー回避のため）
  declare global {
    interface Window {
      onYouTubeIframeAPIReady: () => void;
      YT: any;
    }
  }

  const slider = document.getElementById("video-slider");
  const dots = document.querySelectorAll(".slider-dot");
  const slides = document.querySelectorAll(".video-slide");

  if (slider && slides.length > 0) {
    const getActiveIndex = () => {
      const sliderRect = slider.getBoundingClientRect();
      const sliderCenter = sliderRect.left + sliderRect.width / 2;
      let minDistance = Infinity;
      let index = 0;
      slides.forEach((slide, i) => {
        const slideRect = slide.getBoundingClientRect();
        const slideCenter = slideRect.left + slideRect.width / 2;
        const distance = Math.abs(sliderCenter - slideCenter);
        if (distance < minDistance) {
          minDistance = distance;
          index = i;
        }
      });
      return index;
    };

    const updateStyles = () => {
      const activeIndex = getActiveIndex();
      slides.forEach((slide, index) => {
        if (index === activeIndex) {
          slide.classList.add("active");
          slide.classList.remove("opacity-40", "scale-95", "lg:scale-[0.93]");
        } else {
          slide.classList.remove("active");
          slide.classList.add("opacity-40", "scale-95");
          if (window.innerWidth >= 1024) {
            slide.classList.add("lg:scale-[0.93]");
          }

          // モバイルのみ: スワイプで非アクティブになったら動画を停止
          if (window.innerWidth < 768) {
            // @ts-ignore
            if (
              typeof players !== "undefined" &&
              players[index] &&
              typeof players[index].pauseVideo === "function"
            ) {
              // @ts-ignore
              players[index].pauseVideo();
            }
          }
        }
      });
      dots.forEach((dot, index) => {
        if (index === activeIndex) {
          dot.classList.add("bg-[#A88B58]", "w-4");
          dot.classList.remove("bg-[#E8E2D9]", "w-2");
        } else {
          dot.classList.remove("bg-[#A88B58]", "w-4");
          dot.classList.add("bg-[#E8E2D9]", "w-2");
        }
      });
    };

    // 初期位置セット
    const initScroll = () => {
      if (!slides[1] || !slider) return;
      slider.style.scrollSnapType = "none";
      slider.style.scrollBehavior = "auto";
      const setPosition = () => {
        const slide = slides[1];
        const sliderRect = slider.getBoundingClientRect();
        const slideRect = slide.getBoundingClientRect();
        const currentOffset = slideRect.left - sliderRect.left;
        const centerOffset = (sliderRect.width - slideRect.width) / 2;
        slider.scrollLeft += currentOffset - centerOffset;
        updateStyles();
        requestAnimationFrame(() => {
          slider.style.visibility = "visible";
          slider.style.opacity = "1";
          setTimeout(() => {
            slider.style.scrollSnapType = "x mandatory";
            slider.style.scrollBehavior = "smooth";
          }, 50);
        });
      };
      requestAnimationFrame(() => requestAnimationFrame(setPosition));
    };

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initScroll);
    } else {
      initScroll();
    }

    // スクロールイベント
    let isScrolling: any;
    slider.addEventListener("scroll", () => {
      window.clearTimeout(isScrolling);
      requestAnimationFrame(updateStyles);
      isScrolling = setTimeout(updateStyles, 66);
    });

    // ドットクリック
    dots.forEach((dot, i) => {
      dot.addEventListener("click", () => {
        slides[i].scrollIntoView({
          behavior: "smooth",
          block: "nearest",
          inline: "center",
        });
      });
    });

    // --- ここからYouTube制御ロジック ---

    // プレーヤーインスタンスを保持する配列
    const players: any[] = [];
    let ytApiResolve: any;
    const ytApiPromise = new Promise((resolve) => {
      ytApiResolve = resolve;
    });

    const loadYouTubeAPI = () => {
      if ((window as any).YT && (window as any).YT.Player) {
        ytApiResolve((window as any).YT);
        return;
      }

      const tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName("script")[0];
      if (firstScriptTag && firstScriptTag.parentNode) {
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      }

      window.onYouTubeIframeAPIReady = () => {
        ytApiResolve((window as any).YT);
      };
    };

    // Intersection Observer でビデオセクションが見えたら API を読み込む
    const videoSection = document.getElementById("video-slider");
    if (videoSection) {
      const observer = new IntersectionObserver(
        (entries) => {
          if (entries[0].isIntersecting) {
            loadYouTubeAPI();
            observer.disconnect();
          }
        },
        { rootMargin: "200px" },
      );
      observer.observe(videoSection);
    }

    // プレーヤー初期化
    const initPlayer = async (index: number) => {
      if (players[index]) return players[index];

      // APIの読み込みを待つ
      const YT = await ytApiPromise;

      return new Promise((resolve) => {
        const slide = slides[index];
        const iframe = slide.querySelector("iframe");
        if (iframe && iframe.dataset.src) {
          iframe.src = iframe.dataset.src;

          players[index] = new (YT as any).Player(iframe.id, {
            events: {
              onReady: () => {
                resolve(players[index]);
              },
              onStateChange: (event: any) => {
                if (
                  event.data === (YT as any).PlayerState.PLAYING ||
                  event.data === (YT as any).PlayerState.BUFFERING
                ) {
                  slide.classList.add("is-playing");
                  if (event.data === (YT as any).PlayerState.PLAYING) {
                    players.forEach((p, i) => {
                      if (
                        i !== index &&
                        p &&
                        typeof p.pauseVideo === "function"
                      ) {
                        p.pauseVideo();
                      }
                    });
                  }
                }
              },
            },
          });
        }
      });
    };

    // 初期状態で動画をプリロード
    ytApiPromise.then(() => {
      // 全動画をプリロードして、どの動画をタップしても即再生可能に
      slides.forEach((_, i) => initPlayer(i));
    });

    // PC用: 左右の動画をクリックした時の処理
    const clickAreas = document.querySelectorAll(".slide-click-area");
    clickAreas.forEach((area) => {
      area.addEventListener("click", async () => {
        const index = Number((area as HTMLElement).dataset.index);

        // 1. 中央に移動
        slides[index].scrollIntoView({
          behavior: "smooth",
          block: "nearest",
          inline: "center",
        });

        // 2. プレーヤーを初期化して再生
        const player = await initPlayer(index);
        setTimeout(() => {
          if (player && typeof (player as any).playVideo === "function") {
            (player as any).playVideo();
          }
        }, 400);
      });
    });

    // モバイル用（またはPCオーバーレイ）: 再生ボタンタップで再生開始
    const triggerAreas = document.querySelectorAll(".video-trigger-area");
    triggerAreas.forEach((area) => {
      area.addEventListener("click", async (e) => {
        e.stopPropagation();
        const index = Number((area as HTMLElement).dataset.index);

        // アクティブでないスライドがクリックされた場合はまずスクロール
        const slide = slides[index];
        if (!slide.classList.contains("active")) {
          slide.scrollIntoView({
            behavior: "smooth",
            block: "nearest",
            inline: "center",
          });

          // スクロール完了を待ってから再生
          const player = await initPlayer(index);
          setTimeout(() => {
            if (player && typeof (player as any).playVideo === "function") {
              (player as any).playVideo();
            }
          }, 400);
        } else {
          // すでにアクティブなら即座に再生
          const player = await initPlayer(index);
          if (player && typeof (player as any).playVideo === "function") {
            (player as any).playVideo();
          }
        }
      });
    });
  }
</script>
